var x=Object.defineProperty,xe=Object.defineProperties,Ne=Object.getOwnPropertyDescriptor,ye=Object.getOwnPropertyDescriptors,he=Object.getOwnPropertyNames,H=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,Ae=Object.prototype.propertyIsEnumerable;var K=(e,t,o)=>t in e?x(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,N=(e,t)=>{for(var o in t||(t={}))G.call(t,o)&&K(e,o,t[o]);if(H)for(var o of H(t))Ae.call(t,o)&&K(e,o,t[o]);return e},y=(e,t)=>xe(e,ye(t));var n=(e,t)=>()=>(e&&(t=e(e=0)),t);var w=(e,t)=>{for(var o in t)x(e,o,{get:t[o],enumerable:!0})},Se=(e,t,o,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of he(t))!G.call(e,s)&&s!==o&&x(e,s,{get:()=>t[s],enumerable:!(r=Ne(t,s))||r.enumerable});return e};var d=e=>Se(x({},"__esModule",{value:!0}),e);function W(e,t){let o=`${V}`;return V+=1,c[o]={handler:t,name:e},function(){delete c[o]}}function h(e,t){let o=!1;return W(e,function(...r){o!==!0&&(o=!0,t(...r))})}function q(e,t){for(let o in c)c[o].name===e&&c[o].handler.apply(null,t)}var c,V,j=n(()=>{c={},V=0;typeof window=="undefined"?figma.ui.onmessage=function([e,...t]){q(e,t)}:window.onmessage=function(e){if(typeof e.data.pluginMessage=="undefined")return;let[t,...o]=e.data.pluginMessage;q(t,o)}});function f(e){let t=e.parent;if(t===null)throw new Error("`node.parent` is `null`");return t}var A=n(()=>{});function Y(e){let t=e.getPluginData(I);return t===""?{}:JSON.parse(t)}function z(e,t){if(Object.keys(t).length===0){e.setPluginData(I,"");return}e.setPluginData(I,JSON.stringify(t))}var I,J=n(()=>{I="relaunchButtons"});function S(e,t,o={description:""}){let r=y(N({},Y(e)),{[t]:o.description});z(e,r),e.setRelaunchData(r)}var X=n(()=>{J()});function C(e){if(e.length<2)return!0;let[t,...o]=e,r=f(t);for(let s of o)if(s.parent===null||s.parent.id!==r.id)return!1;return!0}var E=n(()=>{A()});function B(e){if(e.length<2)return e.slice();let t=f(e[0]);if(C(e)===!1)throw new Error("Nodes in `siblingNodes` do not have the same parent");return e.slice().map(function(o){return{index:t.children.indexOf(o),node:o}}).sort(function(o,r){return o.index-r.index}).map(function({node:o}){return o})}var Q=n(()=>{A();E()});function Z(e,t){if(e.length!==t.length)return!1;for(let o in e)if(e[o]!==t[o])return!1;return!0}var ee=n(()=>{});function M(e){let t=f(e[0]);if(C(e)===!1)throw new Error("Nodes in `siblingNodes` do not have the same parent");let o=e.slice(),r=t.children.map(function({id:i}){return i}),s=Ce(o,r);for(let i of o)t.insertChild(s,i);let a=t.children.map(function({id:i}){return i});return Z(r,a)===!1}function Ce(e,t){let o=-1;for(let r of e){let s=t.indexOf(r.id);s>o&&(o=s)}return o+1}var te=n(()=>{ee();A();E()});async function u(e,t=oe){let o=await figma.clientStorage.getAsync(t);return typeof o=="undefined"?e:Object.assign({},e,o)}async function _(e,t=oe){await figma.clientStorage.setAsync(t,e)}var oe,re=n(()=>{oe="settings"});function m(e){return`${ve} ${ne} ${e}`}function l(e){return`${Fe} ${ne} ${e}`}var ve,Fe,ne,se=n(()=>{ve="\u2714",Fe="\u2718",ne="\xA0"});function O(e,t,o){return e===1?t:typeof o=="undefined"?`${t}s`:o}var ie=n(()=>{});function U(e,t){if(typeof __html__=="undefined")throw new Error("No UI defined");let o=`<div id="create-figma-plugin"></div><script>document.body.classList.add('theme-${figma.editorType}');const __FIGMA_COMMAND__='${typeof figma.command=="undefined"?"":figma.command}';const __SHOW_UI_DATA__=${JSON.stringify(typeof t=="undefined"?{}:t)};${__html__}</script>`;figma.showUI(o,y(N({},e),{themeColors:typeof e.themeColors=="undefined"?!0:e.themeColors}))}var ae=n(()=>{});var p=n(()=>{j();X();Q();te();re();se();ie();ae()});function v(e){for(let t of e)t.reactions=[]}var b=n(()=>{"use strict"});function F(){let e=figma.currentPage.findChildren(function(t){return(t.type==="FRAME"||t.type==="COMPONENT")&&t.visible===!0});return B(e).reverse()}var T=n(()=>{"use strict";p()});var g,P,D=n(()=>{"use strict";g="2022-04-01",P={flowName:"Start",shouldNumberFrameNodes:!0}});function me(e){let t=e.slice().reverse(),o=0;for(;o<t.length-1;){let r=t[o],a=[{action:{destinationId:t[o+1].id,navigation:"NAVIGATE",preserveScrollPosition:!1,transition:null,type:"NODE"},trigger:{type:"ON_CLICK"}}];r.reactions=a,o+=1}}var fe=n(()=>{"use strict"});function de(e){let t=1,o=`${e.length}`.length;for(let r of e.slice().reverse())r.name=`${t}`.padStart(o,"0"),t+=1}var ce=n(()=>{"use strict"});function ue(e){let t=Pe(e),o=[];for(let r of t)o=o.concat(we(r).reverse());return o.reverse()}function Pe(e){let[t,...o]=Ie(e).reverse(),r=[],s=[t],a=t.y+t.height;for(let i of o){if(i.y>a){r.push(s),s=[i],a=i.y+i.height;continue}s.push(i),a=Math.max(i.y+i.height,a)}return r.push(s),r}function we(e){return e.slice().sort(function(t,o){return t.x!==o.x?o.x-t.x:o.y-t.y})}function Ie(e){return e.slice().sort(function(t,o){return t.y!==o.y?o.y-t.y:o.x-t.x})}var le=n(()=>{"use strict"});var R={};w(R,{default:()=>Ee});async function Ee(){let e=F();if(e.length<2){figma.closePlugin(l("Need at least 2 frames"));return}let{flowName:t,shouldNumberFrameNodes:o}=await u(P,g);v(e),e=ue(e),M(e),o===!0&&de(e),me(e),figma.currentPage.flowStartingPoints=[{name:t,nodeId:e[e.length-1].id}],S(figma.currentPage,"link-slides"),S(figma.currentPage,"unlink-slides"),figma.closePlugin(m(`Linked ${e.length} ${O(e.length,"slide")}`))}var $=n(()=>{"use strict";p();b();T();D();fe();ce();le()});var L={};w(L,{default:()=>Be});async function Be(){let e=F();if(e.length===0){figma.closePlugin(l("No frames on page"));return}v(e),figma.currentPage.flowStartingPoints=[],figma.closePlugin(m("Unlinked slides"))}var k=n(()=>{"use strict";p();b();T()});var pe={};w(pe,{default:()=>Me});async function Me(){h("CLOSE_UI",function(){figma.closePlugin()}),h("SUBMIT",async function(t){await _(t,g),figma.closePlugin(m("Saved settings"))});let e=await u(P,g);U({height:136,title:"Settings",width:240},e)}var ge=n(()=>{"use strict";p();D()});var _e={"src/link-slides/main.ts--default":($(),d(R)).default,"src/unlink-slides/main.ts--default":(k(),d(L)).default,"src/settings/main.ts--default":(ge(),d(pe)).default,"link-slides":($(),d(R)).default,"unlink-slides":(k(),d(L)).default},Oe=typeof figma.command=="undefined"||figma.command===""?"src/link-slides/main.ts--default":figma.command;_e[Oe]();
